Fix applied by dave
Additional fix by Eve
Frank's changes
